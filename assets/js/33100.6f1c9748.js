(self.webpackChunkdevelopers_doc=self.webpackChunkdevelopers_doc||[]).push([[33100],{15906:(e,t,s)=>{"use strict";s.d(t,{d:()=>n});const n="@selfcommunity/react-ui"},16682:(e,t,s)=>{"use strict";s.d(t,{A:()=>b});var n=s(85486),r=s(59703),o=s(75659),i=s(54533),a=s(96540),l=s(11848),c=s(25669),d=s(28466),u=s(38413),m=s(31609);function g(e){return(0,m.Ay)("MuiImageListItemBar",e)}(0,u.A)("MuiImageListItemBar",["root","positionBottom","positionTop","positionBelow","titleWrap","titleWrapBottom","titleWrapTop","titleWrapBelow","titleWrapActionPosLeft","titleWrapActionPosRight","title","subtitle","actionIcon","actionIconActionPosLeft","actionIconActionPosRight"]);var h=s(74848);const A=["actionIcon","actionPosition","className","subtitle","title","position"],p=(0,l.Ay)("div",{name:"MuiImageListItemBar",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,t[`position${(0,d.A)(s.position)}`]]}})((({theme:e,ownerState:t})=>(0,r.A)({position:"absolute",left:0,right:0,background:"rgba(0, 0, 0, 0.5)",display:"flex",alignItems:"center",fontFamily:e.typography.fontFamily},"bottom"===t.position&&{bottom:0},"top"===t.position&&{top:0},"below"===t.position&&{position:"relative",background:"transparent",alignItems:"normal"}))),f=(0,l.Ay)("div",{name:"MuiImageListItemBar",slot:"TitleWrap",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.titleWrap,t[`titleWrap${(0,d.A)(s.position)}`],s.actionIcon&&t[`titleWrapActionPos${(0,d.A)(s.actionPosition)}`]]}})((({theme:e,ownerState:t})=>(0,r.A)({flexGrow:1,padding:"12px 16px",color:(e.vars||e).palette.common.white,overflow:"hidden"},"below"===t.position&&{padding:"6px 0 12px",color:"inherit"},t.actionIcon&&"left"===t.actionPosition&&{paddingLeft:0},t.actionIcon&&"right"===t.actionPosition&&{paddingRight:0}))),v=(0,l.Ay)("div",{name:"MuiImageListItemBar",slot:"Title",overridesResolver:(e,t)=>t.title})((({theme:e})=>({fontSize:e.typography.pxToRem(16),lineHeight:"24px",textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}))),j=(0,l.Ay)("div",{name:"MuiImageListItemBar",slot:"Subtitle",overridesResolver:(e,t)=>t.subtitle})((({theme:e})=>({fontSize:e.typography.pxToRem(12),lineHeight:1,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap"}))),x=(0,l.Ay)("div",{name:"MuiImageListItemBar",slot:"ActionIcon",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.actionIcon,t[`actionIconActionPos${(0,d.A)(s.actionPosition)}`]]}})((({ownerState:e})=>(0,r.A)({},"left"===e.actionPosition&&{order:-1}))),b=a.forwardRef((function(e,t){const s=(0,c.b)({props:e,name:"MuiImageListItemBar"}),{actionIcon:a,actionPosition:l="right",className:u,subtitle:m,title:b,position:w="bottom"}=s,C=(0,n.A)(s,A),M=(0,r.A)({},s,{position:w,actionPosition:l}),O=(e=>{const{classes:t,position:s,actionIcon:n,actionPosition:r}=e,i={root:["root",`position${(0,d.A)(s)}`],titleWrap:["titleWrap",`titleWrap${(0,d.A)(s)}`,n&&`titleWrapActionPos${(0,d.A)(r)}`],title:["title"],subtitle:["subtitle"],actionIcon:["actionIcon",`actionIconActionPos${(0,d.A)(r)}`]};return(0,o.A)(i,g,t)})(M);return(0,h.jsxs)(p,(0,r.A)({ownerState:M,className:(0,i.A)(O.root,u),ref:t},C,{children:[(0,h.jsxs)(f,{ownerState:M,className:O.titleWrap,children:[(0,h.jsx)(v,{className:O.title,children:b}),m?(0,h.jsx)(j,{className:O.subtitle,children:m}):null]}),a?(0,h.jsx)(x,{ownerState:M,className:O.actionIcon,children:a}):null]}))}))},19249:(e,t,s)=>{"use strict";s.d(t,{E4:()=>i,TY:()=>d,WW:()=>o,Yc:()=>c,cJ:()=>a,gg:()=>n,m6:()=>r,tE:()=>u,zG:()=>l});const n="image",r="video",o="doc",i="url",a="share",l="event",c="sc_link",d="sc_shared_event",u=3},26576:function(e,t){!function(e){"use strict";function t(e,t,s){return t in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}var s="opts_init",n=1e3,r=Array.prototype.concat,o=function(e){var r;return!0===e[s]?e:(t(r={},s,!0),t(r,"recursive",!0===e||!!e.recursive),t(r,"withFullPath",!!e.withFullPath),t(r,"bail",e.bail&&e.bail>0?e.bail:n),r)},i=function(e,t){var s=new File([e],t,{type:e.type,lastModified:e.lastModified});return s.hdcFullPath=t,s},a=function(e,t){return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).withFullPath?i(e,t):e},l=function(e,t){return new Promise((function(s,n){e.file?e.file((function(n){return s(a(n,e.fullPath,t))}),n):s(null)})).catch((function(){return null}))},c=function(e){return"file"===e.kind},d=function(e){return e.getAsEntry?e.getAsEntry():e.webkitGetAsEntry?e.webkitGetAsEntry():null},u=function(e){return r.apply([],e)},m=function(e,t,s){return e.isDirectory?t.recursive?g(e,t,s+1):Promise.resolve([]):l(e,t).then((function(e){return e?[e]:[]}))},g=function(e,t){var s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;return e&&s<t.bail&&e.isDirectory&&e.createReader?new Promise((function(n){var r=[],o=e.createReader(),i=function(){Promise.all(r.map((function(e){return m(e,t,s)}))).then((function(e){return n(u(e))}))};!function e(){o.readEntries((function(t){t.length?(r=r.concat(t),e()):i()}),i)}()})):Promise.resolve([])},h=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return g(d(e),o(t))},A=function(e,t){return h(e,t).then((function(t){if(!t.length){var s=e.getAsFile();t=s?[s]:t}return t}))},p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return t=o(t),new Promise((function(s){e.dataTransfer.items?Promise.all(u(e.dataTransfer.items).filter((function(e){return c(e)})).map((function(e){return A(e,t)}))).then((function(e){return s(u(e))})):e.dataTransfer.files?s(u(e.dataTransfer.files)):s([])}))};e.getFiles=h,e.getFilesFromDragEvent=p,Object.defineProperty(e,"__esModule",{value:!0})}(t)},29251:(e,t,s)=>{"use strict";s.d(t,{A:()=>w});var n=s(31635),r=s(74848),o=s(19546),i=s.n(o),a=s(11848),l=s(46831),c=s(44675),d=s(90508),u=s(4671),m=s(40059),g=s(77037),h=s(28968),A=s(15993),p=s(5448);const f="SCBaseDialog",v={root:`${f}-root`,titleRoot:`${f}-title-root`},j=(0,a.Ay)(l.A,{name:f,slot:"Root",overridesResolver:(e,t)=>t.titleRoot})((({theme:e})=>({}))),x=({children:e=null,onClose:t=null})=>{const s=(0,c.A)(),n=(0,d.A)(s.breakpoints.down("md"),{noSsr:(0,p.Nh)()});return(0,r.jsxs)(j,Object.assign({className:v.titleRoot},{children:[(0,r.jsx)("span",{children:e}),t?(0,r.jsx)(u.A,Object.assign({"aria-label":"close",onClick:t},{children:(0,r.jsx)(m.A,{children:n?"arrow_back":"close"})})):null]}))},b=(0,a.Ay)(g.A,{name:f,slot:"Root",overridesResolver:(e,t)=>t.root})((({theme:e})=>({})));const w=function(e){const t=(0,c.A)(),s=(0,d.A)(t.breakpoints.down("md"),{noSsr:(0,p.Nh)()}),o=s,{className:a="",title:l="",subtitle:u=null,DialogContentProps:m={dividers:!s},open:g=!1,onClose:f=null,actions:j=null,children:w,maxWidth:C="sm",scroll:M="body"}=e,O=(0,n.__rest)(e,["className","title","subtitle","DialogContentProps","open","onClose","actions","children","maxWidth","scroll"]);return(0,r.jsxs)(b,Object.assign({className:i()(v.root,a),fullScreen:o,fullWidth:!0,open:g,onClose:f,maxWidth:C,scroll:M},O,{children:[(0,r.jsx)(x,Object.assign({onClose:f},{children:l})),u&&u,(0,r.jsx)(h.A,Object.assign({},m,{children:w})),j&&(0,r.jsx)(A.A,{children:j})]}))}},44817:(e,t,s)=>{"use strict";s.d(t,{Cy:()=>m,HY:()=>h,K$:()=>u,Xl:()=>A,lT:()=>p,qc:()=>d,sb:()=>g});var n=s(33439);const r="admin",o="moderator",i="editor",a="publisher",l=1;function c(e){if(e&&e.role){const t=e.role;if(t===r)return r;if(t===o)return o;if(t===i)return i;if(t===a)return a}return null}function d(e){return c(e)===r}function u(e){return e&&e.id===l}function m(e){return c(e)===o}function g(e){return c(e)===i}function h(e){return c(e)===a}function A(e){return d(e)||m(e)||g(e)}function p(e){return e&&e.status&&e.status===n.O.BLOCKED}},46222:(e,t,s)=>{"use strict";const n=s(80748);"undefined"!=typeof window&&"Worker"in window&&(n.GlobalWorkerOptions.workerPort=new Worker(new URL(s.p+s.u(51114),s.b))),e.exports=n},47265:(e,t,s)=>{"use strict";s.d(t,{A:()=>d});var n=s(96540),r=s(42269),o=s(13550),i=s(29368),a=s(27375),l=s(94520),c=s(2877);function d({id:e=null,user:t=null}){const s=(0,c.X1)(),d=s.user?s.user.id:null,u=(0,n.useMemo)((()=>d?t:(0,a.$i)(t,["connection_status"])),[t]),[m,g]=(0,n.useState)(u),[h,A]=(0,n.useState)(null),[p,f]=(0,n.useState)(!1),v=(0,n.useMemo)((()=>()=>o.A.request({url:i.A.User.url({id:t?t.id:e}),method:i.A.User.method}).then((e=>e.status>=300?Promise.reject(e):Promise.resolve(e.data)))),[e,t]),j=(0,n.useMemo)((()=>()=>p?Promise.reject():(f(!0),v().then((e=>{f(!1),g(d?e:(0,a.$i)(e,["connection_status"]))})).catch((t=>{f(!1),A(`Unable to refresh user with id ${e}`),l.V.error(r.K,`Unable to refresh user with id ${e}`),l.V.error(r.K,t.message)})))),[v,p]);return(0,n.useEffect)((()=>{e?v().then((e=>{g(d?e:(0,a.$i)(e,["connection_status"]))})).catch((t=>{A(`User with id ${e} not found`),l.V.error(r.K,`User with id ${e} not found`),l.V.error(r.K,t.message)})):g(u)}),[e,u]),{scUser:m,setSCUser:g,refresh:j,refreshing:p,error:h}}},49350:(e,t,s)=>{"use strict";s.d(t,{A:()=>o});s(96540);var n=s(30332),r=s(74848);const o=(0,n.A)((0,r.jsx)("path",{d:"M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"}),"Close")},50064:(e,t,s)=>{"use strict";s.d(t,{A:()=>Xe});var n=s(31635),r=s(74848),o=s(96540),i=s(2773),a=s(13550),l=s(29368),c=s(2877),d=s(47265),u=s(44817),m=s(32678),g=s(67227),h=s(11848),A=s(36870),p=s(44675),f=s(90508),v=s(82241),j=s(73785);const x="SCPrivateMessageThreadItem",b={root:`${x}-skeleton-root`,list:`${x}-list`},w=(0,h.Ay)(A.Ay,{name:x,slot:"SkeletonRoot"})((()=>({})));function C(e){const t=(0,p.A)(),s=(0,f.A)(t.breakpoints.down("md"));return(0,r.jsx)(w,Object.assign({className:b.root},e,{children:(0,r.jsx)(v.A,{sx:{display:"flex",justifyContent:e.index%2==0?"flex-start":"flex-end"},primary:(0,r.jsx)(j.A,{animation:"wave",height:100,width:s?200:300,style:{borderRadius:t.shape.borderRadius}})})}))}var M=s(71194),O=s(42942),y=s(40059),k=s(47859),S=s(4671),I=s(6442),E=s(19546),B=s.n(E),R=s(79197),N=s(54521);function P(e){const t=["Bytes","KB","MB","GB","TB"];if(0===e)return"n/a";const s=parseInt(Math.floor(Math.log(e)/Math.log(1024)).toString());return 0===s?`${e} ${t[s]}`:`${(e/Math.pow(1024,s)).toFixed(1)} ${t[s]}`}var D=s(29251);const U=s(38427).A;var T=s(87631),H=s(18590);const L="data:image/png;base64,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",W="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAuUlEQVR4nO3WQQpCMRRD0axCxP0vSRRXExE6EMHBl5e09uVCcSiHBi2Q/isKzw3AeQcIATwAXJyQ6uwYiiH3t0/pzNSQE4Cr42YohsCFoQFiwdAEkWNohLySYdwQGWYGRIKZBSnHOP7Zj7zNtoCw4gtnx0BGuZHimGl1mxaLz7cCaTctVwyk241Q9Cv1WSDtpuWKgXS7EeathbUeja4YyCg3UhwzrVGmVRwzrVGmteq0uMj5uW0gCeaeAHHCuEhTlUIAAAAASUVORK5CYII=",F=1920;function $(e){const t=e.split(".").pop().toLowerCase();return["mp4","webm","ogv","mp3","m3u8","mpd"].includes(t)}function Q(e,t){let s=e.split(","),n=s[0].match(/:(.*?);/)[1],r=atob(s[1]),o=r.length,i=new Uint8Array(o);const a=t.file&&t.file.type.startsWith(m.em.DOCUMENT)?t.file.name.replace(/(\.[^.]+)$/,".jpeg"):t.name;for(;o--;)i[o]=r.charCodeAt(o);return new File([i],a,{type:n})}function z(e){return new Promise((function(t,s){try{t(Q("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyCAYAAAAeP4ixAAAACXBIWXMAAAsTAAALEwEAmpwYAAABVElEQVR4nO3Xu0rEUBDG8b8PoJUXrAT3EWxsrOztLHwISwtRK1sVS7e1tbQWLBWs3EJ8BhsFr4WMBKaQRV3WnJlkwnwwBAI5OT/OJSeQiRUxqjtgvgsQ8caIlkWbrhgxhAy+XWcLv8MVMgPceo2MGELwxIgxxA0jDhAXjDhBzDHiCKlihvGGmGGagJhgmoIUx1gfUcapQYmXlkydg2arII30QxLSwRFZB/rAAbAJzEWFPAwt2BdgH5iMBnn8ZQd6Ba6A5egQ0TrsCuQoEuQZWAE2gFPgIyrkaejeArAHnAOrkSHjRhKiyRHRTABvXZhaa/p8KMgisAWcAGfANfAZDbIEvP/x0at2Lo9+1G5gd8TXu/rnDgHZHgE5jgLp6Tr4CXEPTEda7D09yV4CN8AFsANM1elAW7bfUpGEaHJECkdyamlyahWO5NTSSMvq3+kMJINzvgAzxLJFazyrgQAAAABJRU5ErkJggg==",e))}catch(n){s(n),console.log(n)}}))}function Z(e,t){const n=s(46222);return new Promise((function(s,r){try{if(t.file.name.endsWith(".pdf")){const o=document.createElement("canvas"),i=o.getContext("2d");n.getDocument(e).promise.then((e=>e.getPage(1))).then((e=>{const t=e.getViewport({scale:1});o.width=t.width,o.height=t.height;const s={canvasContext:i,viewport:t};return e.render(s).promise})).then((()=>{const e=o.toDataURL("image/jpeg",1);s(Q(e,t))})).catch((e=>(console.error("Error converting PDF to JPEG:",e),r(e),Promise.reject(e))))}else s(Q(W,t))}catch(o){r(o),console.log(o)}}))}function K(e,t){return new Promise((function(s,n){try{const n=document.createElement("video");n.src=e,n.crossOrigin="*",$(t.file.name)?n.addEventListener("seeked",(function(){const e=document.createElement("canvas");e.width=F;const r=F/n.videoWidth;e.height=n.videoHeight*r;e.getContext("2d").drawImage(n,0,0,e.width,e.height);const o=e.toDataURL("image/jpeg",.5);s(Q(o,t))})):s(Q("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGAAAABgCAYAAADimHc4AAAACXBIWXMAAAsTAAALEwEAmpwYAAACYUlEQVR4nO3cvWoUURjG8T/YrGAROzFi5Q1oa+Fd2Jp02tiGpPcCvAE/+mxAvIpEsfILBat0ogtJsBKfsDA2h4zuTDL7vjvn+cHTHrLPO3POptgDZmZmZmZmZmZmZmZmZmZpXAU2gT3gM3ACaEVy0vzN0+YzrLFCLgM7wCxBkbqgzD/LNjAhuevAQYLCNFDeATdJ6gZwmKAkDZzD5rOm23beJihHS8pBtu1oJ0EpWnLmZ8J53AOeAx+bvATu9P22M6YDVwtm1nz2Li4B94E3LWv+Bh51HcBmgjIUlI0FO7oCPAa+LbDmfAh3uwxgL0ERCsruf7q5BjwBfnRc91WXAXxNUISCMv9n7Sy3gKfAr57rfu8ygOMERSgoR2f08Rr4cwFrL0yVpzTUuq1UeUoeAB5A+FMpvwHxxchbUHw58hkw/pSGWreVKk/JA8ADCH8q5Tcgvhh5C4ovRz4Dxp/SUOu2UuUpeQB4AOFPpfwGxBcjb0Hx5chnwPhTGmrdVqo8JQ8ADyD8qZTfgPhi5C0ovhz5DBh/SkOt20qVp+QB4AGEP5XyGxBfjLwFxZcjnwHjT2modVup8pQ8ADyA8KdSfgPii5G3oPhyVMMZcJSgBNX8I70vCYpQUD5l+JnqNEERqvmH2hsJilBQHmS4qqDWyzp+9rjKbJHLOh7Sw3aCQrTkbHH+62qeAe+BD8AL4HbfxSYjv6pMRfazXdg0t17RlWXrJL60bz9BSarx0r6/Js2ZMBvZgbuVcdv5l7XmK+q0+Ydlla61OW7+5t3mq+ZKXdxqZmZmZmZmZmZmZmZmZkZ3p+uwFZYL7fr1AAAAAElFTkSuQmCC",t)),n.currentTime=1}catch(r){n(r),console.log(r)}}))}const V={root:`${x}-root`,username:`${x}-username`,text:`${x}-text`,img:`${x}-img`,document:`${x}-document`,video:`${x}-video`,other:`${x}-other`,iconButton:`${x}-icon-button`,messageTime:`${x}-message-time`,menuItem:`${x}-menu-item`,downloadButton:`${x}-download-button`,dialogRoot:`${x}-dialog-root`},_=(0,h.Ay)(D.A,{name:x,slot:"DialogRoot"})((()=>({}))),Y=(0,h.Ay)(A.Ay,{name:x,slot:"Root"})((()=>({})));const G=function(e){var t;const s=(0,R.A)({props:e,name:x}),{message:i=null,className:a=null,mouseEvents:l={},isHovering:d=null,showMenuIcon:u=!1,onMenuIconClick:g=null}=s,h=(0,n.__rest)(s,["message","className","mouseEvents","isHovering","showMenuIcon","onMenuIconClick"]),A=(0,I.A)(),v=(0,o.useContext)(c.T6),j=(0,p.A)(),b=(0,f.A)(j.breakpoints.down("md")),w=i?i.file:null,[E,D]=(0,o.useState)(!1),{enqueueSnackbar:L}=(0,H.dh)(),W=e=>(0,n.__awaiter)(this,void 0,void 0,(function*(){try{const t=yield fetch(e.url),s=yield t.blob(),n=URL.createObjectURL(s),r=document.createElement("a");r.href=n,r.download=e.filename,r.click(),URL.revokeObjectURL(n),r.remove()}catch(t){console.log(t),L(t,{variant:"error",autoHideDuration:3e3})}}));return i?(0,r.jsxs)(Y,Object.assign({className:B()(V.root,a)},(F=l.onMouseEnter,Q=l.onMouseLeave,{onMouseEnter:F,onMouseLeave:Q,onTouchStart:F,onTouchMove:Q}),h,{secondaryAction:(d||b)&&u&&i.status!==m.v8.HIDDEN&&(0,r.jsx)(N.A,{onMenuItemDeleteClick:()=>{g()}})},{children:[i.group&&(null===(t=null==v?void 0:v.user)||void 0===t?void 0:t.username)!==i.sender.username&&(0,r.jsx)(k.A,Object.assign({color:"secondary",variant:"h4",className:V.username},{children:i.sender.username})),(0,r.jsxs)(r.Fragment,{children:[w&&i.status!==m.v8.HIDDEN?(e=>{if(!e)return null;let t=null;const s=(0,r.jsx)(M.A,Object.assign({className:V.other},{children:(0,r.jsxs)(O.A,Object.assign({onClick:()=>W(e.file),startIcon:(0,r.jsx)(y.A,{children:"download"})},{children:[(0,r.jsx)(k.A,{children:e.file.filename}),(0,r.jsx)(k.A,{children:P(e.file.filesize)})]}))}));if(e.file){let n=e.file.mimetype;switch(!0){case n.startsWith(m.em.IMAGE):t=(0,r.jsx)(M.A,Object.assign({className:V.img},{children:(0,r.jsx)("img",{src:e.file.thumbnail,loading:"lazy",alt:"img",onClick:()=>D(!0)})}));break;case n.startsWith(m.em.VIDEO):t=$(e.file.filename)?(0,r.jsxs)(M.A,Object.assign({className:B()(V.img,V.video)},{children:[(0,r.jsx)("img",{src:e.file.thumbnail,loading:"lazy",alt:"img"}),(0,r.jsx)(S.A,Object.assign({onClick:()=>D(!0)},{children:(0,r.jsx)(y.A,{children:"play_circle_outline"})}))]})):s;break;case n.startsWith(m.em.DOCUMENT):t=(0,r.jsxs)(M.A,Object.assign({className:e.file.filename.endsWith(".pdf")?V.document:V.other},{children:[e.file.filename.endsWith(".pdf")&&(0,r.jsx)("img",{src:e.file.thumbnail,loading:"lazy",alt:"img"}),(0,r.jsxs)(O.A,Object.assign({onClick:()=>W(e.file),startIcon:(0,r.jsx)(y.A,{children:"download"})},{children:[(0,r.jsx)(k.A,{children:e.file.filename}),(0,r.jsx)(k.A,{children:P(e.file.filesize)})]}))]}));break;default:t=s}}return(0,r.jsx)(r.Fragment,{children:t})})(i):(0,r.jsx)(M.A,Object.assign({className:V.text},{children:(0,r.jsx)(k.A,{component:"span",dangerouslySetInnerHTML:{__html:i.message}})})),(0,r.jsx)(k.A,Object.assign({className:V.messageTime,color:"text.secondary"},{children:`${A.formatDate(i.created_at,{hour:"numeric",minute:"numeric"})}`}))]}),E&&(0,r.jsx)(r.Fragment,{children:(null==i?void 0:i.file.mimetype.startsWith(m.em.VIDEO))?(0,r.jsx)(_,Object.assign({open:E,onClose:()=>D(!1),className:V.dialogRoot},{children:(0,r.jsx)(T.A,{url:null==i?void 0:i.file.url,width:"100%"})})):(0,r.jsx)(U,{images:[{src:null==i?void 0:i.file.url,key:i.file.uuid}],onClose:()=>D(!1),toolbarButtons:(0,r.jsx)(S.A,Object.assign({onClick:()=>W(null==i?void 0:i.file),className:V.downloadButton},{children:(0,r.jsx)(y.A,{children:"download"})}),"download")})})]})):(0,r.jsx)(C,{elevation:0});var F,Q};var q=s(23224),J=s.n(q),X=s(27885),ee=s(58065),te=s(57156),se=s(25292),ne=s(28820),re=s(78222),oe=s(59223),ie=s(27365),ae=s(5696),le=s(43581),ce=s(80766),de=s(41071),ue=s(34069),me=s(20973),ge=s(69981),he=s(16682),Ae=s(56545),pe=s(45284),fe=s(86857),ve=s(24760),je=s(5784),xe=s(67743),be=s(15906),we=s(94520);const Ce=e=>{const{type:t=null,onSuccess:s=null,onProgress:r=null,onError:i=null}=e,c=(0,o.useRef)(!0),d=o.useRef({chunks:{},setChunk:null,setChunks:null}),[u,g]=(0,o.useState)({});d.current={chunks:u,setChunk:e=>{const t=Object.assign(Object.assign({},d.current.chunks),{[e.id]:Object.assign(Object.assign({},d.current.chunks[e.id]),e)});g(t),d.current.chunks=t},setChunks:g};const h=(0,pe.J_)(),A=(0,I.A)(),p=e=>e.startsWith(m.em.IMAGE);(0,o.useEffect)((()=>{c.current?c.current=!1:r&&r(u)}),[u]),(0,je.Jg)((e=>{if(!e.file.type.startsWith(m.em.DOCUMENT)){const t=new FileReader;t.onload=t=>{p(e.file.type)?d.current.setChunk({id:e.id,file_url:t.target.result}):d.current.setChunk({id:e.id,video_url:t.target.result})},t.readAsDataURL(e.file)}d.current.setChunk({id:e.id,file_uuid:null,completed:0,file:e.file,totalparts:null})})),(0,je.OE)((e=>{d.current.setChunk({id:e.id,completed:e.completed})}));const f=(e,t)=>{const n=new FormData;n.append("file",t),n.append("parentuuid",e.uploadResponse.results[0].data.file_uuid),a.A.request({url:l.A.PrivateMessageUploadThumbnail.url(),method:l.A.PrivateMessageUploadThumbnail.method,data:n,headers:{"Content-Type":"multipart/form-data"}}).then((t=>{const n=Object.assign({},d.current.chunks);delete n[e.id],d.current.setChunks(n);let r=t.data;r.file=e.file,s(r)})).catch((t=>{t=(0,ve.zl)(t),i(Object.assign({},d.current.chunks[e.id]),t.fileError?A.formatMessage(xe.A.fileUploadErrorGeneric):A.formatMessage(xe.A.messageFileUploadError,{filename:e.file.name}));const s=Object.assign({},d.current.chunks);delete s[e.id],d.current.setChunks(s)}))};return(0,Ae.IN)((e=>{const t=e.file.type.startsWith(m.em.VIDEO)?K:e.file.type.startsWith(m.em.AUDIO)?z:Z,s=new FormData;s.append("uuid",d.current.chunks[e.id].file_uuid),s.append("filename",d.current.chunks[e.id].file.name),s.append("totalparts",d.current.chunks[e.id].totalparts),a.A.request({url:l.A.PrivateMessageChunkUploadDone.url(),method:l.A.PrivateMessageChunkUploadDone.method,data:s,headers:{"Content-Type":"multipart/form-data"}}).then((s=>{p(e.file.type)?f(e,e.file):((e,t,s)=>{e(s,t).then((e=>{f(t,e)})).catch((e=>{console.log(e),i(Object.assign({},d.current.chunks[t.id]),A.formatMessage(xe.A.messageFileUploadError,{filename:t.file.name}));const s=Object.assign({},d.current.chunks);delete s[t.id],d.current.setChunks(s)}))})(t,e,s.data.file_url)})).catch((t=>{t=(0,ve.zl)(t),i(Object.assign({},d.current.chunks[e.id]),t.fileError?A.formatMessage(xe.A.fileUploadErrorGeneric):A.formatMessage(xe.A.messageFileUploadError,{filename:e.file.name}));const s=Object.assign({},d.current.chunks);delete s[e.id],d.current.setChunks(s)}))})),(0,Ae.Xy)((e=>{i(Object.assign({},d.current.chunks[e.id]),A.formatMessage(xe.A.error));const t=Object.assign({},d.current.chunks);delete t[e.id],d.current.setChunks(t)})),(0,Ae.Y2)((e=>{const s={url:`${h.settings.portal}${l.A.PrivateMessageUploadMediaInChunks.url()}`,sendOptions:{paramName:"file",headers:{Authorization:`Bearer ${h.settings.session.authToken.accessToken}`},method:l.A.PrivateMessageUploadMediaInChunks.method}};if(e.totalCount>1){let t={partindex:e.chunk.index,totalparts:e.totalCount};d.current.chunks[e.item.id].file_uuid&&(t.uuid=d.current.chunks[e.item.id].file_uuid),s.sendOptions.params=t}else d.current.setChunk({id:e.item.id,type:t||e.sendOptions.paramName});return s})),(0,Ae.Ui)((e=>{d.current.setChunk({id:e.item.id,file_uuid:e.uploadData.response.data.file_uuid,totalparts:e.chunk.index+1})})),(0,Ae.gr)((({items:e,options:t})=>0==e.length?Promise.resolve({options:t}):p(e[0].file.type)?new Promise(((s,r)=>{Promise.all(e.map((e=>(0,n.__awaiter)(void 0,void 0,void 0,(function*(){return Object.assign(Object.assign({},e),{file:"image/gif"===e.file.type?e.file:yield(t=e.file,new Promise((function(e,s){try{const n=new FileReader;n.onload=s=>{let n=new Image;n.onload=function(){const s=document.createElement("canvas"),r=s.getContext("2d");s.width=F;const o=F/n.width;s.height=n.height*o,r.drawImage(n,0,0,s.width,s.height);const i=s.toDataURL("image/jpeg",.5);e(Q(i,t))},n.src=s.target.result},n.onerror=s,n.readAsDataURL(t)}catch(n){s(n),console.log(n)}})))});var t}))))).then((e=>{s({items:e,options:{inputFieldName:t.inputFieldName}})})).catch((e=>{we.V.error(e,be.d),s({options:{inputFieldName:t.inputFieldName}})}))})):Promise.resolve({options:{inputFieldName:t.inputFieldName}}))),null};var Me=s(26576),Oe=s(44112),ye=s(12341);function ke(){return ke=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var n in s)Object.prototype.hasOwnProperty.call(s,n)&&(e[n]=s[n])}return e},ke.apply(this,arguments)}const Se=(e,t,s)=>{const n="dragleave"===e.type?e.relatedTarget:e.target;return n===t||s&&t?.contains(n)},Ie=(0,o.forwardRef)((({className:e,id:t,children:s,onDragOverClassName:n,dropHandler:r,htmlDirContentParams:i,shouldRemoveDragOver:a,shouldHandleDrag:l,enableOnContains:c=!0,extraProps:d,...u},m)=>{const{upload:g}=(0,ye.Bx)(),h=(0,o.useRef)(null),A=(0,o.useRef)(!1);(0,o.useImperativeHandle)(m,(()=>h.current),[]);const p=(0,o.useRef)();p.current=u;const f=(0,o.useCallback)((()=>{A.current=!1,h.current&&n&&h.current.classList.remove(n)}),[n,h]),v=(0,o.useCallback)((e=>{const t=()=>(0,Me.getFilesFromDragEvent)(e,i||{});return r?Promise.resolve(r(e,t)):t()}),[r,i]),j=(0,o.useCallback)((e=>{v(e).then((e=>{g(e,p.current)}))}),[g,v,p]),x=(0,o.useCallback)((e=>{((e,t)=>(0,Oe.Im)(t)||!0===t||(0,Oe.Tn)(t)&&t(e))(e,l)&&Se(e,h.current,c)&&(A.current=!0,h.current&&n&&h.current.classList.add(n))}),[n,h,l,c]),b=(0,o.useCallback)((e=>{A.current&&e.preventDefault()}),[]),w=(0,o.useCallback)((e=>{A.current&&(e.preventDefault(),e.persist(),f(),j(e))}),[f,j]),C=(0,o.useCallback)((e=>{(A.current&&!Se(e,h.current,c)||a?.(e))&&f()}),[f,h,a,c]),M=(0,o.useCallback)((e=>{A.current&&(e.preventDefault(),e.stopPropagation(),f())}),[f]);return o.createElement("div",ke({id:t,className:e,ref:h,onDragOver:b,onDragEnter:x,onDrop:w,onDragLeave:C,onDragEnd:M},d),s)}));(0,ye.QB)(Ie);const Ee=Ie,Be="SCPrivateMessageEditor",Re=10485760,Ne=(0,de.If)((0,o.forwardRef)(((e,t)=>(0,r.jsx)(S.A,Object.assign({},e,{ref:t,color:"inherit"},{children:(0,r.jsx)(y.A,{children:"upload"})}))))),Pe={root:`${Be}-message-media-uploader-root`,uploadSection:`${Be}-upload-section`,uploadButton:`${Be}-upload-button`,closeButton:`${Be}-close-button`,previewContent:`${Be}-preview-content`,previewItem:`${Be}-preview-item`,previewActions:`${Be}-preview-actions`,progress:`${Be}-progress`,previewInfo:`${Be}-preview-info`},De=(0,h.Ay)(fe.A,{name:Be,slot:"MessageMediaUploader"})((()=>({})));function Ue(e){const{className:t,forwardMessageFile:s,onClose:n,isUploading:i,action:a}=e,[c,d]=(0,o.useState)([]),[u,g]=(0,o.useState)({}),[h,p]=(0,o.useState)([]),[f,v]=(0,o.useState)({}),[j,x]=(0,o.useState)({}),b=(0,o.useContext)(pe.GD),w=(e,t)=>e.filter((e=>e.file_uuid!=t)),C=e=>()=>{delete f[e],v(Object.assign({},f))};return(0,r.jsxs)(De,Object.assign({className:B()(Pe.root,t)},{children:[(0,r.jsx)(ue.A,{action:(0,r.jsx)(y.A,Object.assign({onClick:n,className:Pe.closeButton},{children:"close"}))}),Object.keys(f).map((e=>(0,r.jsx)(me.A,Object.assign({in:!0},{children:(0,r.jsxs)(ce.A,Object.assign({severity:"error",onClose:C(e)},{children:[(0,r.jsx)(ge.A,{children:f[e].name}),f[e].error]}))}),e))),(0,r.jsx)(se.A,{children:(0,r.jsxs)(Ae.Ay,Object.assign({destination:{url:`${b.settings.portal}${l.A.PrivateMessageUploadMediaInChunks.url()}`,headers:{Authorization:`Bearer ${b.settings.session.authToken.accessToken}`},method:l.A.PrivateMessageUploadMediaInChunks.method},chunkSize:204800,multiple:!0,chunked:!0,maxConcurrent:2,fileFilter:e=>e.size<Re},{children:[(0,r.jsx)(Ce,{onSuccess:e=>{d((t=>[...t,e]))},onProgress:e=>{g(Object.assign({},e)),p([...c,...Object.values(e)]),i(0!==Object.keys(e).length),0===Object.keys(e).length&&0!==Object.keys(u).length&&s(c)},onError:(e,t)=>{v(Object.assign(Object.assign({},f),{[e.id]:Object.assign(Object.assign({},e),{error:t})}))}}),!c.length&&0===Object.keys(u).length&&0===Object.keys(f).length&&(0,r.jsxs)(Ee,Object.assign({className:Pe.uploadSection},{children:[(0,r.jsx)(Ne,{inputFieldName:"file",className:Pe.uploadButton}),(0,r.jsx)(k.A,Object.assign({textAlign:"center",fontWeight:"medium"},{children:(0,r.jsx)(ee.A,{id:"ui.privateMessage.editor.media.uploader.msg",defaultMessage:"ui.privateMessage.editor.media.uploader.msg"})}))]})),(0,r.jsxs)(ne.A,Object.assign({className:Pe.previewContent},{children:[0!==h.length&&h.map(((e,t)=>{var n,i,a;return(0,r.jsx)(o.Fragment,{children:"file"in e&&(0,r.jsxs)(A.Ay,Object.assign({className:Pe.previewItem},(i=()=>(e=>{x((t=>Object.assign(Object.assign({},t),{[e]:!0})))})(e.file_uuid),a=()=>(e=>{x((t=>Object.assign(Object.assign({},t),{[e]:!1})))})(e.file_uuid),{onMouseEnter:i,onMouseLeave:a,onTouchStart:i,onTouchMove:a}),{children:["video_url"in e?(0,r.jsx)("video",{src:e.video_url}):(0,r.jsx)("img",{src:e.file.type.startsWith(m.em.PDF)&&!e.file_url?L:e.file_url?e.file_url:W}),(0,r.jsx)(he.A,{className:B()(Pe.previewActions,{[Pe.progress]:e.completed}),title:void 0!==e.completed&&0!==e.completed&&(0,r.jsx)(k.A,Object.assign({textAlign:"center"},{children:`${Math.round(e.completed)}%`})),actionIcon:(0,r.jsx)(r.Fragment,{children:j[e.file_uuid]&&0===Object.keys(u).length&&(0,r.jsx)(S.A,Object.assign({onClick:()=>{return(t=e.file_uuid)?(p((e=>w(e,t))),d((e=>w(e,t))),s(w(c,t))):(d([]),p([]),s([])),void g({});var t},size:"small"},{children:(0,r.jsx)(y.A,{children:"delete"})}))})}),j[e.file_uuid]&&(0,r.jsxs)(M.A,Object.assign({component:"span",className:Pe.previewInfo},{children:[(0,r.jsx)(k.A,Object.assign({noWrap:!0,textAlign:"center"},{children:e.file.name})),(0,r.jsx)(k.A,Object.assign({textAlign:"center",fontWeight:"light"},{children:P(e.file.size)}))]}))]}),null!==(n=e.id)&&void 0!==n?n:e.file_uuid)},t)})),0!==h.length&&a]}))]}))})]}))}var Te=s(4032),He=s(23922);const Le=(0,X.YK)({placeholder:{id:"ui.privateMessage.editor.placeholder",defaultMessage:"ui.privateMessage.editor.placeholder"}}),We={root:`${Be}-root`,ios:`${Be}-ios`,messageInput:`${Be}-message-input`,mediaUploader:`${Be}-media-uploader`,emojiSection:`${Be}-emoji-section`},Fe=(0,h.Ay)(M.A,{name:Be,slot:"Root"})((()=>({})));const $e=function(e){const t=(0,R.A)({props:e,name:Be}),{autoHide:s=null,className:i=null,send:a=null,onThreadChangeId:l,error:c=!1,onErrorRemove:d=null,autoHideDeletion:u}=t,m=(0,n.__rest)(t,["autoHide","className","send","onThreadChangeId","error","onErrorRemove","autoHideDeletion"]),[g,h]=(0,o.useState)(""),[A,p]=(0,o.useState)([]),[f,v]=(0,o.useState)(!1),[j,x]=(0,o.useState)(!1),[b,w]=(0,o.useState)(null),[C,M]=(0,o.useState)(!1),O=(0,I.A)(),k=(0,o.useRef)(null),E=()=>{v(!1),p([])},N=e=>{p(e)},P=()=>{A.length?A.map((e=>{a(g,e.file_uuid)})):a(g,""),h(""),p([]),v(!1),x(!1)},D=e=>{h(e.target.value)},U=(e,t)=>{const s=k.current.selectionEnd,n=k.current.value.substring(0,k.current.selectionStart),r=k.current.value.substring(k.current.selectionStart);h(n+e.emoji+r),setTimeout((()=>{k.current.selectionStart=k.current.selectionEnd=s+e.emoji.length}),50)};(0,o.useEffect)((()=>{w(l),b!==l&&(h(""),p([]),v(!1))}),[l]);const T=(0,o.useMemo)((()=>(0,He.O)()),[]);return s||u?(0,r.jsx)(ce.A,Object.assign({severity:u?"warning":"info"},{children:u?(0,r.jsx)(ee.A,{id:"ui.privateMessage.editor.disabled.deleted.msg",defaultMessage:"ui.privateMessage.editor.disabled.deleted.msg"}):(0,r.jsx)(ee.A,{id:"ui.privateMessage.editor.disabled.msg",defaultMessage:"ui.privateMessage.editor.disabled.msg"})})):c?(0,r.jsx)(ce.A,Object.assign({severity:"error",action:(0,r.jsx)(S.A,Object.assign({color:"inherit",size:"small",onClick:d},{children:(0,r.jsx)(y.A,{children:"close"})}))},{children:(0,r.jsx)(ee.A,{id:"ui.privateMessage.editor.error.send.msg",defaultMessage:"ui.privateMessage.editor.error.send.msg"})})):(0,r.jsx)(Fe,Object.assign({},m,{className:B()(We.root,i,{[We.ios]:T})},{children:(0,r.jsx)(r.Fragment,{children:f?(0,r.jsx)(Ue,{className:We.mediaUploader,open:f,onClose:E,forwardMessageFile:N,isUploading:M,action:(0,r.jsx)(S.A,Object.assign({disabled:!g&&!A.length||C,onClick:P},{children:(0,r.jsx)(y.A,{children:"send"})}))}):(0,r.jsxs)(r.Fragment,{children:[j&&(0,r.jsx)(Te.A,{className:We.emojiSection,onEmojiClick:U,width:"100%",searchDisabled:!0}),(0,r.jsx)(le.A,{size:"small",inputRef:k,disabled:Boolean(A.length)||f,className:We.messageInput,multiline:!0,placeholder:`${O.formatMessage(Le.placeholder)}`,value:g,onChange:D,maxRows:2,onSelect:()=>x(!1),InputProps:{startAdornment:(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(S.A,Object.assign({disabled:f,onClick:()=>x(!j)},{children:(0,r.jsx)(y.A,{children:"sentiment_satisfied_alt"})})),(0,r.jsx)(S.A,Object.assign({disabled:""!==g||j,onClick:()=>v(!0)},{children:(0,r.jsx)(y.A,{children:"attach_file"})}))]}),endAdornment:(0,r.jsx)(S.A,Object.assign({disabled:!g&&!A.length||C,onClick:P},{children:(0,r.jsx)(y.A,{children:"send"})}))}})]})})}))},Qe="SCPrivateMessageThread",ze={root:`${Qe}-skeleton-root`,list:`${Qe}-list`,editor:`${Qe}-editor`},Ze=(0,h.Ay)(te.A,{name:Qe,slot:"SkeletonRoot"})((()=>({})));function Ke(e){const t=(0,p.A)(),s=(0,f.A)(t.breakpoints.down("sm"));return(0,r.jsx)(Ze,Object.assign({className:ze.root},e,{children:(0,r.jsxs)(se.A,{children:[(0,r.jsxs)(ne.A,Object.assign({className:ze.list},{children:[(0,r.jsx)(re.A,Object.assign({sx:{display:"flex",justifyContent:"center"}},{children:(0,r.jsx)(j.A,{animation:"wave",height:30,width:120,style:{borderRadius:20}})})),[...Array(s?6:8)].map(((e,t)=>(0,r.jsx)(C,{index:t},t)))]})),(0,r.jsx)(M.A,Object.assign({className:ze.editor},{children:(0,r.jsx)(j.A,{animation:"wave",height:55,width:"100%",variant:"rectangular"})}))]})}))}var Ve=s(81327),_e=s(21022),Ye=s(43749);const Ge=(0,X.YK)({placeholder:{id:"ui.privateMessage.thread.newMessage.autocomplete.placeholder",defaultMessage:"ui.privateMessage.thread.newMessage.autocomplete.placeholder"},messageDeleted:{id:"ui.privateMessage.thread.message.deleted",defaultMessage:"ui.privateMessage.thread.message.deleted"}}),qe={root:`${Qe}-root`,subHeader:`${Qe}-subheader`,section:`${Qe}-section`,emptyMessage:`${Qe}-empty-message`,newMessageHeader:`${Qe}-new-message-header`,newMessageHeaderContent:`${Qe}-new-message-header-content`,newMessageHeaderIcon:`${Qe}-new-message-header-icon`,newMessageContent:`${Qe}-new-message-content`,sender:`${Qe}-sender`,receiver:`${Qe}-receiver`,avatar:`${Qe}-avatar`,item:`${Qe}-item`,autocomplete:`${Qe}-autocomplete`,autocompleteDialog:`${Qe}-autocomplete-dialog`,editor:`${Qe}-editor`},Je=(0,h.Ay)(te.A,{name:Qe,slot:"Root"})((()=>({})));const Xe=function(e){const t=(0,R.A)({props:e,name:Qe}),{threadObj:s,openNewMessage:h=!1,onNewMessageClose:A=null,onNewMessageSent:p=null,onSingleMessageOpen:f=null,className:v,type:j}=t,x=(0,n.__rest)(t,["threadObj","openNewMessage","onNewMessageClose","onNewMessageSent","onSingleMessageOpen","className","type"]),b=(0,o.useContext)(c.T6),[w,O]=(0,o.useState)(""),[E,N]=(0,o.useState)(null),[P,D]=(0,o.useState)([]),[U,T]=(0,o.useState)(!0),[L,W]=(0,o.useState)(!1),[F,$]=(0,o.useState)({}),[Q,z]=(0,o.useState)([]),Z=s&&s===m.v8.NEW,K=b.user?b.user.id:null,[V,_]=(0,o.useState)(null),[Y,q]=(0,o.useState)(null),[X,te]=(0,o.useState)(null),[ce,de]=(0,o.useState)(!1),[ue,me]=(0,o.useState)(!1),[ge,he]=(0,o.useState)([]),{enqueueSnackbar:Ae,closeSnackbar:pe}=(0,H.dh)(),fe="number"==typeof s,ve=(e,t)=>{var s,n,r;return(null===(s=null==e?void 0:e.receiver)||void 0===s?void 0:s.id)!==t?null===(n=null==e?void 0:e.receiver)||void 0===n?void 0:n.id:null===(r=null==e?void 0:e.sender)||void 0===r?void 0:r.id},[je,xe]=(0,o.useState)(!1),Ce=(0,o.useRef)(null),Me=(0,I.A)(),{scUser:Oe}=(0,d.A)({id:fe&&s,threadObj:s}),ye=(0,o.useRef)(null),ke=()=>{var e;null===(e=ye.current)||void 0===e||e.scrollIntoView({block:"end",behavior:"instant"})},Se=e=>Me.formatDate(e.created_at,{year:"numeric",day:"numeric",month:"long"}),Ie=(0,o.useMemo)((()=>{const e=[...P];return(0,Ve.$z)(e,Se)}),[P]),Ee=()=>{me(!1)},Be=(0,o.useMemo)((()=>ge?Array.isArray(ge)?ge.map((e=>parseInt(e.id,10))):[parseInt(ge.id||ge,10)]:[]),[ge,h]),Re=(e,t,s)=>{switch(s){case"input":O(t),!t&&z([]);break;case"reset":O(t)}},Ne=(e,t,s)=>{switch(e.preventDefault(),e.stopPropagation(),s){case"selectOption":Pe(e),he(t);break;case"removeOption":Pe(e,t)}return!1},Pe=(e,t)=>{O(""),z([]),he(null!=t?t:[])},De=()=>{Pe(),A&&A()};function Ue(e,t,s,n){const r=new URL(e);return r.searchParams.set(t,s),r.searchParams.delete(n),r.toString()}const Te=(0,o.useMemo)((()=>()=>{if(E)return a.A.request({url:E,method:l.A.GetAThread.method}).then((e=>{const t=[...P];t.unshift(...e.data.results),D(t),N(e.data.next&&Ue(e.data.next,"before_message",e.data.results[0].id,"offset"))})).catch((e=>console.log(e)))}),[E,P]),He=e=>{const t=new Date(e);return(new Date).getTime()-t.getTime()<6e4};function Le(){const e=He(X.created_at);i.A.deleteAMessage(X.id).then((()=>{const t=P.filter((e=>e.id!==X.id));e?D(t):function(e){const t=[...P],s=t.findIndex((t=>t.id===e));-1!==s&&(t[s].message=`${Me.formatMessage(Ge.messageDeleted)}`,t[s].file=null,t[s].status=m.v8.HIDDEN,D(t))}(X.id),We(t.length>=1&&e||!e&&X.id!==P.slice(-1)[0].id?t.slice(-1):[X]),Ee()})).catch((e=>{console.log(e);let t=Ae((0,r.jsx)(ee.A,{id:"ui.privateMessage.thread.error.delete.msg",defaultMessage:"ui.privateMessage.thread.error.delete.msg"}),{variant:"error",SnackbarProps:{onClick:()=>{pe(t)}}})}))}function We(e){J().publish("snippetsChannel",e)}function Fe(e,t){u.lT(b.user)?Ae((0,r.jsx)(ee.A,{id:"ui.common.userBlocked",defaultMessage:"ui.common.userBlocked"}),{variant:"warning",autoHideDuration:3e3}):a.A.request({url:l.A.SendMessage.url(),method:l.A.SendMessage.method,data:Object.assign(Object.assign({},j===m.DZ.GROUP?{group:fe?s:s.group.id}:{recipients:h||Z||ce?Be:[fe&&s?s:ve(s,K)]}),{message:e,file_uuid:t&&!e?t:null})}).then((e=>{const t=e.data.length<=1;t&&D((t=>[...t,e.data[0]])),We(e.data),(h||ce)&&(de(!1),f(!1),he([]),p(e.data[0],t)),ke()})).catch((e=>{console.log(e),xe(!0)}))}const ze=(0,o.useCallback)((()=>()=>{T(!0),D([]),N(null),q(null),de(!1)}),[T,D,N,q,de]);(0,o.useEffect)((()=>{w&&(W(!0),i.A.searchUser(w).then((e=>{W(!1),z(e.results.filter((e=>e.id!==K)))})).catch((e=>{W(!1),console.log(e)})))}),[w]),(0,o.useEffect)((()=>{K&&(s?function(){if(s&&"string"!=typeof s&&j!==m.DZ.GROUP){T(!0);const e=fe?s:ve(s,K);i.A.getAThread({user:e,limit:10}).then((t=>{D(t.results),N(t.next&&Ue(t.next,"before_message",t.results[0].id,"offset")),t.results.length?(t.results[0].receiver.id!==K?q(t.results[0].receiver):q(t.results[0].sender),de(!1)):(null==Oe?void 0:Oe.can_send_pm_to)?(de(!0),he(e),f(!0),_(Oe)):de(!1),T(!1)})).catch((e=>{T(!1),console.log(e),we.V.error(be.d,{error:e})}))}else j===m.DZ.GROUP&&i.A.getAThread({group:fe?s:s.group.id,limit:10}).then((e=>{D(e.results),N(e.next&&Ue(e.next,"before_message",e.results[0].id,"offset")),T(!1),de(!1)})).catch((e=>{T(!1),console.log(e),we.V.error(be.d,{error:e})}))}():ze())}),[s,K,Oe]);const Ze=(e,t)=>{const n=t.data,r=[...P].findIndex((e=>e.thread_id===n.thread_id)),o=n.notification_obj.message;o.receiver=n.notification_obj.snippet.receiver,o.thread_status=n.notification_obj.snippet.thread_status,We([o]),-1!==r&&D((e=>[...e,n.notification_obj.message])),(fe?s===n.thread_id:s.id===n.thread_id)&&ke()};return(0,o.useEffect)((()=>(Ce.current=J().subscribe(`${g.f.INTERACTION}.${g.x.PRIVATE_MESSAGE}`,Ze),()=>{J().unsubscribe(Ce.current)})),[P]),K?(0,r.jsx)(Je,Object.assign({},x,{className:B()(qe.root,v)},{children:null===s||Z||ce?(0,r.jsx)(se.A,{children:Z||ce?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsxs)(M.A,Object.assign({className:qe.newMessageHeader},{children:[(0,r.jsxs)(M.A,Object.assign({className:qe.newMessageHeaderContent},{children:[(0,r.jsx)(y.A,Object.assign({className:qe.newMessageHeaderIcon},{children:"person"})),(0,r.jsx)(k.A,{children:(0,r.jsx)(ee.A,{defaultMessage:"ui.privateMessage.thread.newMessage.to",id:"ui.privateMessage.thread.newMessage.to"})}),(0,r.jsx)(ae.A,{className:qe.autocomplete,loading:L,multiple:!ce,limitTags:3,freeSolo:!0,disableClearable:!0,options:Q,onChange:Ne,onInputChange:Re,inputValue:w,value:ce?V:ge,getOptionLabel:e=>e?e.username:"...",isOptionEqualToValue:(e,t)=>!!e&&t.id===e.id,renderInput:e=>(0,r.jsx)(le.A,Object.assign({},e,{placeholder:ce?"...":`${Me.formatMessage(Ge.placeholder)}`,variant:"standard",InputProps:Object.assign(Object.assign({},e.InputProps),{disableUnderline:!0})})),classes:{popper:qe.autocompleteDialog},disabled:Boolean(V)})]})),(0,r.jsx)(S.A,Object.assign({size:"small",onClick:De},{children:(0,r.jsx)(y.A,{children:"close"})}))]})),(0,r.jsx)(ne.A,{className:qe.newMessageContent}),(0,r.jsx)($e,{className:qe.editor,send:Fe,autoHide:!Q,error:je,onErrorRemove:()=>xe(!1)})]}):(0,r.jsx)(k.A,Object.assign({className:qe.emptyMessage},{children:(0,r.jsx)(ee.A,{id:"ui.privateMessage.thread.emptyBox.message",defaultMessage:"ui.privateMessage.thread.emptyBox.message"})}))}):U?(0,r.jsx)(Ke,{}):(0,r.jsxs)(se.A,{children:[(0,r.jsx)(Ye.A,Object.assign({height:"100%",dataLength:P.length,previous:Te,inverse:!0,hasMorePrevious:Boolean(E),loaderPrevious:(0,r.jsx)(C,{})},{children:(0,r.jsx)(ne.A,Object.assign({ref:ye},{children:Object.keys(Ie).map((e=>(0,r.jsx)("li",Object.assign({className:qe.section},{children:(0,r.jsxs)("ul",{children:[(0,r.jsx)(re.A,{children:(0,r.jsx)(k.A,Object.assign({align:"center",className:qe.subHeader},{children:e}))}),Ie[e].map((e=>{var t;return(0,r.jsxs)(M.A,Object.assign({className:qe.item},{children:[e.group&&(null===(t=null==b?void 0:b.user)||void 0===t?void 0:t.username)!==e.sender.username&&(0,r.jsx)(oe.A,{children:(0,r.jsx)(ie.A,{alt:e.sender.username,src:e.sender.avatar,className:qe.avatar})}),(0,r.jsx)(G,{className:K===e.sender.id?qe.sender:qe.receiver,message:e,mouseEvents:{onMouseEnter:()=>{return t=e.id,void $((e=>Object.assign(Object.assign({},e),{[t]:!0})));var t},onMouseLeave:()=>{return t=e.id,void $((e=>Object.assign(Object.assign({},e),{[t]:!1})));var t}},isHovering:F[e.id],showMenuIcon:K===e.sender.id,onMenuIconClick:()=>(e=>{me(!0),te(e)})(e)},e.id)]}),e.id)}))]})}),e)))}))})),(0,r.jsx)($e,{className:qe.editor,send:Fe,autoHide:j!==m.DZ.GROUP&&!(null==Oe?void 0:Oe.can_send_pm_to),autoHideDeletion:j===m.DZ.USER&&((null==Y?void 0:Y.deleted)||(null==Oe?void 0:Oe.deleted)),onThreadChangeId:fe?s:j===m.DZ.USER?s.receiver.id:s.group.id,error:je,onErrorRemove:()=>xe(!1)}),ue&&(0,r.jsx)(_e.A,{open:ue,title:(0,r.jsx)(ee.A,{id:"ui.privateMessage.component.delete.message.dialog.msg",defaultMessage:"ui.privateMessage.component.delete.message.dialog.msg"}),btnConfirm:(0,r.jsx)(ee.A,{id:"ui.privateMessage.component.delete.message.dialog.confirm",defaultMessage:"ui.privateMessage.component.delete.message.dialog.confirm"}),onConfirm:Le,onClose:Ee})]})})):null}},71194:(e,t,s)=>{"use strict";s.d(t,{A:()=>j});var n=s(59703),r=s(85486),o=s(96540),i=s(54533),a=s(11659),l=s(13168),c=s(99918),d=s(75131),u=s(74848);const m=["className","component"];var g=s(79071),h=s(21789),A=s(58312);const p=(0,s(38413).A)("MuiBox",["root"]),f=(0,h.A)(),v=function(e={}){const{themeId:t,defaultTheme:s,defaultClassName:g="MuiBox-root",generateClassName:h}=e,A=(0,a.default)("div",{shouldForwardProp:e=>"theme"!==e&&"sx"!==e&&"as"!==e})(l.A);return o.forwardRef((function(e,o){const a=(0,d.A)(s),l=(0,c.A)(e),{className:p,component:f="div"}=l,v=(0,r.A)(l,m);return(0,u.jsx)(A,(0,n.A)({as:f,ref:o,className:(0,i.A)(p,h?h(g):g),theme:t&&a[t]||a},v))}))}({themeId:A.A,defaultTheme:f,defaultClassName:p.root,generateClassName:g.A.generate}),j=v},80766:(e,t,s)=>{"use strict";s.d(t,{A:()=>R});var n=s(85486),r=s(59703),o=s(96540),i=s(54533),a=s(75659),l=s(56950),c=s(11848),d=s(25669),u=s(6025),m=s(28466),g=s(57416),h=s(38413),A=s(31609);function p(e){return(0,A.Ay)("MuiAlert",e)}const f=(0,h.A)("MuiAlert",["root","action","icon","message","filled","colorSuccess","colorInfo","colorWarning","colorError","filledSuccess","filledInfo","filledWarning","filledError","outlined","outlinedSuccess","outlinedInfo","outlinedWarning","outlinedError","standard","standardSuccess","standardInfo","standardWarning","standardError"]);var v=s(4671),j=s(30332),x=s(74848);const b=(0,j.A)((0,x.jsx)("path",{d:"M20,12A8,8 0 0,1 12,20A8,8 0 0,1 4,12A8,8 0 0,1 12,4C12.76,4 13.5,4.11 14.2, 4.31L15.77,2.74C14.61,2.26 13.34,2 12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0, 0 22,12M7.91,10.08L6.5,11.5L11,16L21,6L19.59,4.58L11,13.17L7.91,10.08Z"}),"SuccessOutlined"),w=(0,j.A)((0,x.jsx)("path",{d:"M12 5.99L19.53 19H4.47L12 5.99M12 2L1 21h22L12 2zm1 14h-2v2h2v-2zm0-6h-2v4h2v-4z"}),"ReportProblemOutlined"),C=(0,j.A)((0,x.jsx)("path",{d:"M11 15h2v2h-2zm0-8h2v6h-2zm.99-5C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8z"}),"ErrorOutline"),M=(0,j.A)((0,x.jsx)("path",{d:"M11,9H13V7H11M12,20C7.59,20 4,16.41 4,12C4,7.59 7.59,4 12,4C16.41,4 20,7.59 20, 12C20,16.41 16.41,20 12,20M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10, 10 0 0,0 12,2M11,17H13V11H11V17Z"}),"InfoOutlined");var O=s(49350);const y=["action","children","className","closeText","color","components","componentsProps","icon","iconMapping","onClose","role","severity","slotProps","slots","variant"],k=(0,c.Ay)(g.A,{name:"MuiAlert",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:s}=e;return[t.root,t[s.variant],t[`${s.variant}${(0,m.A)(s.color||s.severity)}`]]}})((({theme:e})=>{const t="light"===e.palette.mode?l.e$:l.a,s="light"===e.palette.mode?l.a:l.e$;return(0,r.A)({},e.typography.body2,{backgroundColor:"transparent",display:"flex",padding:"6px 16px",variants:[...Object.entries(e.palette).filter((([,e])=>e.main&&e.light)).map((([n])=>({props:{colorSeverity:n,variant:"standard"},style:{color:e.vars?e.vars.palette.Alert[`${n}Color`]:t(e.palette[n].light,.6),backgroundColor:e.vars?e.vars.palette.Alert[`${n}StandardBg`]:s(e.palette[n].light,.9),[`& .${f.icon}`]:e.vars?{color:e.vars.palette.Alert[`${n}IconColor`]}:{color:e.palette[n].main}}}))),...Object.entries(e.palette).filter((([,e])=>e.main&&e.light)).map((([s])=>({props:{colorSeverity:s,variant:"outlined"},style:{color:e.vars?e.vars.palette.Alert[`${s}Color`]:t(e.palette[s].light,.6),border:`1px solid ${(e.vars||e).palette[s].light}`,[`& .${f.icon}`]:e.vars?{color:e.vars.palette.Alert[`${s}IconColor`]}:{color:e.palette[s].main}}}))),...Object.entries(e.palette).filter((([,e])=>e.main&&e.dark)).map((([t])=>({props:{colorSeverity:t,variant:"filled"},style:(0,r.A)({fontWeight:e.typography.fontWeightMedium},e.vars?{color:e.vars.palette.Alert[`${t}FilledColor`],backgroundColor:e.vars.palette.Alert[`${t}FilledBg`]}:{backgroundColor:"dark"===e.palette.mode?e.palette[t].dark:e.palette[t].main,color:e.palette.getContrastText(e.palette[t].main)})})))]})})),S=(0,c.Ay)("div",{name:"MuiAlert",slot:"Icon",overridesResolver:(e,t)=>t.icon})({marginRight:12,padding:"7px 0",display:"flex",fontSize:22,opacity:.9}),I=(0,c.Ay)("div",{name:"MuiAlert",slot:"Message",overridesResolver:(e,t)=>t.message})({padding:"8px 0",minWidth:0,overflow:"auto"}),E=(0,c.Ay)("div",{name:"MuiAlert",slot:"Action",overridesResolver:(e,t)=>t.action})({display:"flex",alignItems:"flex-start",padding:"4px 0 0 16px",marginLeft:"auto",marginRight:-8}),B={success:(0,x.jsx)(b,{fontSize:"inherit"}),warning:(0,x.jsx)(w,{fontSize:"inherit"}),error:(0,x.jsx)(C,{fontSize:"inherit"}),info:(0,x.jsx)(M,{fontSize:"inherit"})},R=o.forwardRef((function(e,t){const s=(0,d.b)({props:e,name:"MuiAlert"}),{action:o,children:l,className:c,closeText:g="Close",color:h,components:A={},componentsProps:f={},icon:j,iconMapping:b=B,onClose:w,role:C="alert",severity:M="success",slotProps:R={},slots:N={},variant:P="standard"}=s,D=(0,n.A)(s,y),U=(0,r.A)({},s,{color:h,severity:M,variant:P,colorSeverity:h||M}),T=(e=>{const{variant:t,color:s,severity:n,classes:r}=e,o={root:["root",`color${(0,m.A)(s||n)}`,`${t}${(0,m.A)(s||n)}`,`${t}`],icon:["icon"],message:["message"],action:["action"]};return(0,a.A)(o,p,r)})(U),H={slots:(0,r.A)({closeButton:A.CloseButton,closeIcon:A.CloseIcon},N),slotProps:(0,r.A)({},f,R)},[L,W]=(0,u.A)("closeButton",{elementType:v.A,externalForwardedProps:H,ownerState:U}),[F,$]=(0,u.A)("closeIcon",{elementType:O.A,externalForwardedProps:H,ownerState:U});return(0,x.jsxs)(k,(0,r.A)({role:C,elevation:0,ownerState:U,className:(0,i.A)(T.root,c),ref:t},D,{children:[!1!==j?(0,x.jsx)(S,{ownerState:U,className:T.icon,children:j||b[M]||B[M]}):null,(0,x.jsx)(I,{ownerState:U,className:T.message,children:l}),null!=o?(0,x.jsx)(E,{ownerState:U,className:T.action,children:o}):null,null==o&&w?(0,x.jsx)(E,{ownerState:U,className:T.action,children:(0,x.jsx)(L,(0,r.A)({size:"small","aria-label":g,title:g,color:"inherit",onClick:w},W,{children:(0,x.jsx)(F,(0,r.A)({fontSize:"small"},$))}))}):null]}))}))},81327:(e,t,s)=>{"use strict";s.d(t,{$z:()=>n,LE:()=>r});const n=(e,t)=>e.reduce((function(e,s){let n="function"==typeof t?t(s):s[t];return e.hasOwnProperty(n)||(e[n]=[]),e[n].push(s),e}),{}),r=(e,t,s=!0)=>{if(!Array.isArray(e))return e;const n=s?(e,s)=>e[t]-s[t]:(e,s)=>s[t]-e[t];return e.sort(n)}},86857:(e,t,s)=>{"use strict";s.d(t,{A:()=>g});var n=s(31635),r=s(74848),o=s(96540),i=s(11848),a=s(57156),l=s(19546),c=s.n(l);const d="SCWidget",u={root:`${d}-root`},m=(0,i.Ay)(a.A,{name:d,slot:"Root",overridesResolver:(e,t)=>t.root})((({theme:e})=>({}))),g=(0,o.forwardRef)(((e,t)=>{const{className:s,onHeightChange:o,onStateChange:i}=e,a=(0,n.__rest)(e,["className","onHeightChange","onStateChange"]);return(0,r.jsx)(m,Object.assign({className:c()(u.root,s)},a,{ref:t}))}))}}]);