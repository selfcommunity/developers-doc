"use strict";(self.webpackChunkdevelopers_doc=self.webpackChunkdevelopers_doc||[]).push([[53802],{21967:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>a,default:()=>p,frontMatter:()=>i,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"sdk/community-js/react-ui/Components/CommentsFeedObject","title":"Comments Feed Object","description":"The Comments Feed Object component renders a list of comment items.","source":"@site/docs/sdk/community-js/react-ui/Components/CommentsFeedObject.mdx","sourceDirName":"sdk/community-js/react-ui/Components","slug":"/sdk/community-js/react-ui/Components/CommentsFeedObject","permalink":"/docs/sdk/community-js/react-ui/Components/CommentsFeedObject","draft":false,"unlisted":false,"editUrl":"https://github.com/selfcommunity/developers-doc/tree/main/docs/sdk/community-js/react-ui/Components/CommentsFeedObject.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Comments Feed Object","sidebar_position":1,"title":"Comments Feed Object"},"sidebar":"sdkSidebar","previous":{"title":"Comment Object","permalink":"/docs/sdk/community-js/react-ui/Components/CommentObject"},"next":{"title":"Custom Adv","permalink":"/docs/sdk/community-js/react-ui/Components/CustomAdv"}}');var s=n(74848),c=n(28453),m=n(37180),r=n(52376);const i={sidebar_label:"Comments Feed Object",sidebar_position:1,title:"Comments Feed Object"},a=void 0,d={},l=[{value:"Usage",id:"usage",level:4}];function u(e){const t={blockquote:"blockquote",code:"code",h4:"h4",p:"p",pre:"pre",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:'The Comments Feed Object component renders a list of comment items.\nThe comments are shown in an orderly manner: few items are full shown while the others can be loaded afterwards by clicking on the "see more comments" button.'}),"\n"]}),"\n","\n",(0,s.jsx)(m.A,{children:(0,s.jsx)(r.A,{feedObjectType:"discussion",feedObjectId:50})}),"\n",(0,s.jsx)(t.h4,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",children:" import React from 'react';\n import {SCContextProvider} from '@selfcommunity/react-core';\n import {CommentsFeedObject} from '@selfcommunity/react-ui';\n\n function App() {\n   const conf = {\n     portal: '<community-path>',\n     session: {\n       type: 'OAuth',\n       token: '<community-token>',\n       refreshToken: '<community-refresh-token>',\n       refreshTokenEndpoint: '<community-refresh-endpoint>',\n     },\n   };\n   return (\n     <SCContextProvider conf={conf}><CommentsFeedObject /></SCContextProvider>\n   );\n }\n"})})]})}function p(e={}){const{wrapper:t}={...(0,c.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},36175:(e,t,n)=>{n.d(t,{F:()=>o});const o={user:{username:"beatrice",password:"Password!!Beatrice2021",client_id:"XJjPE54IBBjhibs0Rf0wZ969cZNPq6WjC02FrkaM",grant_type:"password"},portal:"https://internal.selfcommunity.io/mkg2zxd0"}},37180:(e,t,n)=>{n.d(t,{A:()=>p});var o=n(96540),s=n(36175),c=n(75251);function m(e,t){void 0===e&&(e=""),void 0===t&&(t={});const n=Object.keys(t).map((e=>encodeURIComponent(e)+"="+encodeURIComponent(t[e]))).join("&");return fetch(e,{method:"POST",headers:{accept:"application/json","content-type":"application/x-www-form-urlencoded"},body:n})}function r(){if((0,c.A)()){const e={refresh_token:JSON.parse(window.localStorage.getItem("token")).refresh_token,client_id:s.F.user.client_id,grant_type:"refresh_token"};return m(`${s.F.portal}/oauth/token/`,e).then((e=>e.json())).then((e=>({accessToken:e.access_token,refreshToken:e.refresh_token,tokenType:e.token_type,expiresIn:e.expires_in}))).catch((e=>Promise.reject(e)))}}function i(){const e=(0,c.A)(),[t,n]=(0,o.useState)(e?JSON.parse(window.localStorage.getItem("token")):"");return(0,o.useEffect)((()=>{e&&(!t||1e3*t.expiresIn<Date.now()?m(`${s.F.portal}/oauth/token/`,s.F.user).then((e=>e.json())).then((e=>({accessToken:e.access_token,refreshToken:e.refresh_token,tokenType:e.token_type,expiresIn:e.expires_in}))).catch((e=>e)).then((e=>{n(e)})):e&&n(JSON.parse(window.localStorage.getItem("token"))))}),[e]),(0,o.useEffect)((()=>{e&&window.localStorage.setItem("token",JSON.stringify(t))}),[e,t]),t}var a=n(45284),d=n(28554),l=n(73906),u=n(74848);function p(e){let{children:t}=e;const n=i(),o={portal:s.F.portal,locale:{default:"en"},session:{type:"OAuth",clientId:s.F.user.client_id,authToken:n,handleRefreshToken:r},theme:d.Ay,handleAnonymousAction:()=>{alert("Anonymous action")}};return(0,u.jsx)(l.A,{children:()=>(0,u.jsx)(a.Ay,{conf:o,children:t})})}},52376:(e,t,n)=>{n.d(t,{A:()=>F});var o=n(31635),s=n(74848),c=n(96540),m=n(11848),r=n(71194),i=n(47859),a=n(58065),d=n(38990),l=n(56323),u=n(19546),p=n.n(u),j=n(79197),f=n(58871),h=n(15906),b=n(74531),C=n(13550),O=n(29368),g=n(28692),k=n(94520),y=n(54262),x=n(45738),A=n(83426),_=n(74257),S=n(95241);const P={root:`${S.H}-root`,noComments:`${S.H}-no-comments`,commentNotFound:`${S.H}-comment-not-found`},v=(0,m.Ay)(r.A,{name:S.H,slot:"Root"})((()=>({})));const F=function(e){const t=(0,j.A)({props:e,name:S.H}),{id:n=`comments_object_${t.feedObjectType?t.feedObjectType:t.feedObject?t.feedObject.type:""}_${t.feedObjectId?t.feedObjectId:t.feedObject?t.feedObject.id:""}`,className:m,feedObjectId:u,feedObject:F,feedObjectType:T=A.Z.POST,commentObjectId:N,commentObject:w,CommentComponent:I=d.A,CommentComponentProps:D={variant:"outlined",linkableCommentDateTime:!1},CommentObjectSkeletonProps:E={elevation:0,WidgetProps:{variant:"outlined"}},renderNoComments:R,renderCommentNotFound:B,page:M=1,commentsPageCount:$=_.DE,commentsOrderBy:L=l.e.ADDED_AT_ASC,showTitle:q=!1,infiniteScrolling:H=!0,onChangePage:J,comments:U=[],cacheStrategy:z=g.So.NETWORK_ONLY}=t,W=(0,o.__rest)(t,["id","className","feedObjectId","feedObject","feedObjectType","commentObjectId","commentObject","CommentComponent","CommentComponentProps","CommentObjectSkeletonProps","renderNoComments","renderCommentNotFound","page","commentsPageCount","commentsOrderBy","showTitle","infiniteScrolling","onChangePage","comments","cacheStrategy"]),Z=(0,y.A)({id:u,feedObject:F,feedObjectType:T,offset:(M-1)*$,pageSize:$,orderBy:L,onChangePage:J,cacheStrategy:z}),[V,K]=(0,c.useState)(!1),[X,Y]=(0,c.useState)(null),{obj:G,error:Q}=(0,x.A)({id:N,commentObject:w,cacheStrategy:z}),[ee,te]=(0,c.useState)(null),ne=Z.feedObject?Z.feedObject.id:null,oe=G?G.id:null,se=(0,c.useRef)(),ce=Z.total+U.length,me=(0,c.useMemo)((()=>()=>q?(0,s.jsx)(i.A,Object.assign({variant:"h6",gutterBottom:!0,color:"inherit"},{children:(0,s.jsx)(a.A,{id:"ui.commentsObject.title",defaultMessage:"ui.commentsObject.title",values:{total:ce}})})):null),[ce,V]),re=(0,c.useMemo)((()=>e=>C.A.request({url:O.A.Comment.url({id:e}),method:O.A.Comment.method}).then((e=>e.status>=300?Promise.reject(e):Promise.resolve(e.data)))),[Z.feedObject,N,G]);function ie(e){setTimeout((()=>{const t=se.current?se.current.querySelector(`#comment_object_${e.id}`):null;t&&t.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}),300)}(0,c.useEffect)((()=>{null===ne||V||(N||G?G?G.parent?(K(!0),re(G.parent).then((e=>{const t=Object.assign({},e);t.latest_comments=[G],(0,b.zf)(e).id===Z.feedObject.id?(Y(t),ie(G)):te(!0),K(!1)})).catch((e=>{K(!1),k.V.error(h.d,e)}))):((0,b.zf)(G).id===Z.feedObject.id?(Y(G),ie(G)):te(!0),K(!1)):Q&&K(!1):V||Z.getNextPage())}),[ne,oe]);let ae=(0,s.jsx)(s.Fragment,{});return ae=!Z.componentLoaded||ce||Z.isLoadingNext||V?(0,s.jsxs)(s.Fragment,{children:[Boolean((ee||Q)&&!V&&!ce)&&(0,s.jsx)(s.Fragment,{children:B?B():(0,s.jsx)(r.A,Object.assign({className:P.commentNotFound},{children:(0,s.jsx)(a.A,{id:"ui.commentsObject.commentNotFound",defaultMessage:"ui.commentsObject.commentNotFound"})}))}),(0,s.jsx)(f.A,{feedObject:Z.feedObject,comments:Z.comments,endComments:[...X?[X]:[],...L===l.e.ADDED_AT_ASC?U:[]],startComments:[...L===l.e.ADDED_AT_ASC?[]:U],previous:Z.previous,handlePrevious:Z.getPreviousPage,isLoadingPrevious:Z.isLoadingPrevious,next:Z.next,isLoadingNext:Z.isLoadingNext,handleNext:Z.getNextPage,page:Z.page,previousPage:Z.previousPage,nextPage:Z.nextPage,infiniteScrolling:H&&Z.total>0&&!X&&!U.length,CommentComponent:I,CommentComponentProps:D,CommentObjectSkeletonProps:E})]}):(0,s.jsx)(s.Fragment,{children:R?R():(0,s.jsx)(r.A,Object.assign({className:P.noComments},{children:(0,s.jsx)(a.A,{id:"ui.commentsObject.noComments",defaultMessage:"ui.commentsObject.noComments"})}))}),(0,s.jsxs)(v,Object.assign({id:n,className:p()(P.root,m)},W,{ref:se},{children:[me(),ae]}))}},95241:(e,t,n)=>{n.d(t,{H:()=>o});const o="SCCommentsFeedObject"}}]);