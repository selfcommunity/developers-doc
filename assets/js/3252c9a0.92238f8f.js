"use strict";(self.webpackChunkdevelopers_doc=self.webpackChunkdevelopers_doc||[]).push([[53802],{21967:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>d,contentTitle:()=>m,default:()=>h,frontMatter:()=>a,metadata:()=>o,toc:()=>l});const o=JSON.parse('{"id":"sdk/community-js/react-ui/Components/CommentsFeedObject","title":"Comments Feed Object","description":"The Comments Feed Object component renders a list of comment items.","source":"@site/docs/sdk/community-js/react-ui/Components/CommentsFeedObject.mdx","sourceDirName":"sdk/community-js/react-ui/Components","slug":"/sdk/community-js/react-ui/Components/CommentsFeedObject","permalink":"/docs/sdk/community-js/react-ui/Components/CommentsFeedObject","draft":false,"unlisted":false,"editUrl":"https://github.com/selfcommunity/developers-doc/tree/main/docs/sdk/community-js/react-ui/Components/CommentsFeedObject.mdx","tags":[],"version":"current","sidebarPosition":1,"frontMatter":{"sidebar_label":"Comments Feed Object","sidebar_position":1,"title":"Comments Feed Object"},"sidebar":"sdkSidebar","previous":{"title":"Comment Object","permalink":"/docs/sdk/community-js/react-ui/Components/CommentObject"},"next":{"title":"Custom Adv","permalink":"/docs/sdk/community-js/react-ui/Components/CustomAdv"}}');var s=n(74848),i=n(28453),c=n(37180),r=n(52376);const a={sidebar_label:"Comments Feed Object",sidebar_position:1,title:"Comments Feed Object"},m=void 0,d={},l=[{value:"Usage",id:"usage",level:4}];function u(e){const t={blockquote:"blockquote",code:"code",h4:"h4",p:"p",pre:"pre",...(0,i.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)(t.blockquote,{children:["\n",(0,s.jsx)(t.p,{children:'The Comments Feed Object component renders a list of comment items.\nThe comments are shown in an orderly manner: few items are full shown while the others can be loaded afterwards by clicking on the "see more comments" button.'}),"\n"]}),"\n","\n",(0,s.jsx)(c.A,{children:(0,s.jsx)(r.A,{feedObjectType:"discussion",feedObjectId:50})}),"\n",(0,s.jsx)(t.h4,{id:"usage",children:"Usage"}),"\n",(0,s.jsx)(t.pre,{children:(0,s.jsx)(t.code,{className:"language-jsx",children:" import React from 'react';\n import {SCContextProvider} from '@selfcommunity/react-core';\n import {CommentsFeedObject} from '@selfcommunity/react-ui';\n\n function App() {\n   const conf = {\n     portal: '<community-path>',\n     session: {\n       type: 'OAuth',\n       token: '<community-token>',\n       refreshToken: '<community-refresh-token>',\n       refreshTokenEndpoint: '<community-refresh-endpoint>',\n     },\n   };\n   return (\n     <SCContextProvider conf={conf}><CommentsFeedObject /></SCContextProvider>\n   );\n }\n"})})]})}function h(e={}){const{wrapper:t}={...(0,i.R)(),...e.components};return t?(0,s.jsx)(t,{...e,children:(0,s.jsx)(u,{...e})}):u(e)}},28692:(e,t,n)=>{n.d(t,{Ay:()=>s,So:()=>o});var o;!function(e){e.CACHE_FIRST="Cache-first",e.NETWORK_ONLY="Network-only",e.STALE_WHILE_REVALIDATE="Stale-While-Revalidate"}(o||(o={}));const s=new class{constructor(e=1e4){this.values=new Map,this.maxEntries=e,this.ssr="undefined"==typeof window,this.ssr||(window.__viewSCCache=this.values)}get(e,t,n={noSsr:!0}){let o;return this.values.has(e)?(o=this.values.get(e),this.values.delete(e),this.values.set(e,o)):t&&(o=t,(!this.ssr||!n.noSsr)&&this.values.set(e,o)),o}set(e,t,n={noSsr:!0}){if(!this.ssr||!n.noSsr){if(this.values.size>=this.maxEntries){const e=this.values.keys().next().value;this.values.delete(e)}this.values.set(e,t)}}hasKey(e){return this.values.has(e)}delete(e){this.values.has(e)&&this.values.delete(e)}deleteKeys(e){e.forEach((e=>{this.values.has(e)&&this.values.delete(e)}))}deleteKeysWithPrefix(e){this.values.forEach(((t,n)=>{n.startsWith(e)&&this.values.delete(n)}))}clean(){this.values=new Map}evaluate(){console.log(this.values)}}},29251:(e,t,n)=>{n.d(t,{A:()=>v});var o=n(31635),s=n(74848),i=n(19546),c=n.n(i),r=n(11848),a=n(46831),m=n(44675),d=n(90508),l=n(4671),u=n(40059),h=n(77037),_=n(28968),p=n(15993),j=n(5448);const f="SCBaseDialog",g={root:`${f}-root`,titleRoot:`${f}-title-root`},b=(0,r.Ay)(a.A,{name:f,slot:"Root",overridesResolver:(e,t)=>t.titleRoot})((({theme:e})=>({}))),C=({children:e=null,onClose:t=null})=>{const n=(0,m.A)(),o=(0,d.A)(n.breakpoints.down("md"),{noSsr:(0,j.Nh)()});return(0,s.jsxs)(b,Object.assign({className:g.titleRoot},{children:[(0,s.jsx)("span",{children:e}),t?(0,s.jsx)(l.A,Object.assign({"aria-label":"close",onClick:t},{children:(0,s.jsx)(u.A,{children:o?"arrow_back":"close"})})):null]}))},O=(0,r.Ay)(h.A,{name:f,slot:"Root",overridesResolver:(e,t)=>t.root})((({theme:e})=>({})));const v=function(e){const t=(0,m.A)(),n=(0,d.A)(t.breakpoints.down("md"),{noSsr:(0,j.Nh)()}),i=n,{className:r="",title:a="",subtitle:l=null,DialogContentProps:u={dividers:!n},open:h=!1,onClose:f=null,actions:b=null,children:v,maxWidth:x="sm",scroll:k="body"}=e,y=(0,o.__rest)(e,["className","title","subtitle","DialogContentProps","open","onClose","actions","children","maxWidth","scroll"]);return(0,s.jsxs)(O,Object.assign({className:c()(g.root,r),fullScreen:i,fullWidth:!0,open:h,onClose:f,maxWidth:x,scroll:k},y,{children:[(0,s.jsx)(C,Object.assign({onClose:f},{children:a})),l&&l,(0,s.jsx)(_.A,Object.assign({},u,{children:v})),b&&(0,s.jsx)(p.A,{children:b})]}))}},36175:(e,t,n)=>{n.d(t,{F:()=>o});const o={user:{username:"beatrice",password:"Password!!Beatrice2021",client_id:"XJjPE54IBBjhibs0Rf0wZ969cZNPq6WjC02FrkaM",grant_type:"password"},portal:"https://internal.selfcommunity.io/mkg2zxd0"}},37180:(e,t,n)=>{n.d(t,{A:()=>h});var o=n(96540),s=n(36175),i=n(75251);function c(e,t){void 0===e&&(e=""),void 0===t&&(t={});const n=Object.keys(t).map((e=>encodeURIComponent(e)+"="+encodeURIComponent(t[e]))).join("&");return fetch(e,{method:"POST",headers:{accept:"application/json","content-type":"application/x-www-form-urlencoded"},body:n})}function r(){if((0,i.A)()){const e={refresh_token:JSON.parse(window.localStorage.getItem("token")).refresh_token,client_id:s.F.user.client_id,grant_type:"refresh_token"};return c(`${s.F.portal}/oauth/token/`,e).then((e=>e.json())).then((e=>({accessToken:e.access_token,refreshToken:e.refresh_token,tokenType:e.token_type,expiresIn:e.expires_in}))).catch((e=>Promise.reject(e)))}}function a(){const e=(0,i.A)(),[t,n]=(0,o.useState)(e?JSON.parse(window.localStorage.getItem("token")):"");return(0,o.useEffect)((()=>{e&&(!t||1e3*t.expiresIn<Date.now()?c(`${s.F.portal}/oauth/token/`,s.F.user).then((e=>e.json())).then((e=>({accessToken:e.access_token,refreshToken:e.refresh_token,tokenType:e.token_type,expiresIn:e.expires_in}))).catch((e=>e)).then((e=>{n(e)})):e&&n(JSON.parse(window.localStorage.getItem("token"))))}),[e]),(0,o.useEffect)((()=>{e&&window.localStorage.setItem("token",JSON.stringify(t))}),[e,t]),t}var m=n(45284),d=n(51151),l=n(73906),u=n(74848);function h(e){let{children:t}=e;const n=a(),o={portal:s.F.portal,locale:{default:"en"},session:{type:"OAuth",clientId:s.F.user.client_id,authToken:n,handleRefreshToken:r},theme:d.Ay,handleAnonymousAction:()=>{alert("Anonymous action")}};return(0,u.jsx)(l.A,{children:()=>(0,u.jsx)(m.Ay,{conf:o,children:t})})}},52376:(e,t,n)=>{n.d(t,{A:()=>N});var o=n(31635),s=n(74848),i=n(96540),c=n(11848),r=n(71194),a=n(47859),m=n(58065),d=n(38990),l=n(56323),u=n(19546),h=n.n(u),_=n(79197),p=n(58871),j=n(15906),f=n(74531),g=n(13550),b=n(29368),C=n(28692),O=n(94520),v=n(54262),x=n(45738),k=n(83426),y=n(74257),A=n(95241);const S={root:`${A.H}-root`,noComments:`${A.H}-no-comments`,commentNotFound:`${A.H}-comment-not-found`},$=(0,c.Ay)(r.A,{name:A.H,slot:"Root"})((()=>({})));const N=function(e){const t=(0,_.A)({props:e,name:A.H}),{id:n=`comments_object_${t.feedObjectType?t.feedObjectType:t.feedObject?t.feedObject.type:""}_${t.feedObjectId?t.feedObjectId:t.feedObject?t.feedObject.id:""}`,className:c,feedObjectId:u,feedObject:N,feedObjectType:F=k.Z.POST,commentObjectId:P,commentObject:w,CommentComponent:T=d.A,CommentComponentProps:W={variant:"outlined",linkableCommentDateTime:!1},CommentObjectSkeletonProps:I={elevation:0,WidgetProps:{variant:"outlined"}},renderNoComments:R,renderCommentNotFound:E,page:D=1,commentsPageCount:L=y.DE,commentsOrderBy:M=l.e.ADDED_AT_ASC,showTitle:B=!1,infiniteScrolling:q=!0,onChangePage:H,comments:z=[],cacheStrategy:J=C.So.NETWORK_ONLY}=t,U=(0,o.__rest)(t,["id","className","feedObjectId","feedObject","feedObjectType","commentObjectId","commentObject","CommentComponent","CommentComponentProps","CommentObjectSkeletonProps","renderNoComments","renderCommentNotFound","page","commentsPageCount","commentsOrderBy","showTitle","infiniteScrolling","onChangePage","comments","cacheStrategy"]),K=(0,v.A)({id:u,feedObject:N,feedObjectType:F,offset:(D-1)*L,pageSize:L,orderBy:M,onChangePage:H,cacheStrategy:J}),[V,G]=(0,i.useState)(!1),[Z,Q]=(0,i.useState)(null),{obj:X,error:Y}=(0,x.A)({id:P,commentObject:w,cacheStrategy:J}),[ee,te]=(0,i.useState)(null),ne=K.feedObject?K.feedObject.id:null,oe=X?X.id:null,se=(0,i.useRef)(),ie=K.total+z.length,ce=(0,i.useMemo)((()=>()=>B?(0,s.jsx)(a.A,Object.assign({variant:"h6",gutterBottom:!0,color:"inherit"},{children:(0,s.jsx)(m.A,{id:"ui.commentsObject.title",defaultMessage:"ui.commentsObject.title",values:{total:ie}})})):null),[ie,V]),re=(0,i.useMemo)((()=>e=>g.A.request({url:b.A.Comment.url({id:e}),method:b.A.Comment.method}).then((e=>e.status>=300?Promise.reject(e):Promise.resolve(e.data)))),[K.feedObject,P,X]);function ae(e){setTimeout((()=>{const t=se.current?se.current.querySelector(`#comment_object_${e.id}`):null;t&&t.scrollIntoView({behavior:"smooth",block:"center",inline:"center"})}),300)}(0,i.useEffect)((()=>{null===ne||V||(P||X?X?X.parent?(G(!0),re(X.parent).then((e=>{const t=Object.assign({},e);t.latest_comments=[X],(0,f.zf)(e).id===K.feedObject.id?(Q(t),ae(X)):te(!0),G(!1)})).catch((e=>{G(!1),O.V.error(j.d,e)}))):((0,f.zf)(X).id===K.feedObject.id?(Q(X),ae(X)):te(!0),G(!1)):Y&&G(!1):V||K.getNextPage())}),[ne,oe]);let me=(0,s.jsx)(s.Fragment,{});return me=!K.componentLoaded||ie||K.isLoadingNext||V?(0,s.jsxs)(s.Fragment,{children:[Boolean((ee||Y)&&!V&&!ie)&&(0,s.jsx)(s.Fragment,{children:E?E():(0,s.jsx)(r.A,Object.assign({className:S.commentNotFound},{children:(0,s.jsx)(m.A,{id:"ui.commentsObject.commentNotFound",defaultMessage:"ui.commentsObject.commentNotFound"})}))}),(0,s.jsx)(p.A,{feedObject:K.feedObject,comments:K.comments,endComments:[...Z?[Z]:[],...M===l.e.ADDED_AT_ASC?z:[]],startComments:[...M===l.e.ADDED_AT_ASC?[]:z],previous:K.previous,handlePrevious:K.getPreviousPage,isLoadingPrevious:K.isLoadingPrevious,next:K.next,isLoadingNext:K.isLoadingNext,handleNext:K.getNextPage,page:K.page,previousPage:K.previousPage,nextPage:K.nextPage,infiniteScrolling:q&&K.total>0&&!Z&&!z.length,CommentComponent:T,CommentComponentProps:W,CommentObjectSkeletonProps:I})]}):(0,s.jsx)(s.Fragment,{children:R?R():(0,s.jsx)(r.A,Object.assign({className:S.noComments},{children:(0,s.jsx)(m.A,{id:"ui.commentsObject.noComments",defaultMessage:"ui.commentsObject.noComments"})}))}),(0,s.jsxs)($,Object.assign({id:n,className:h()(S.root,c)},U,{ref:se},{children:[ce(),me]}))}},86354:(e,t,n)=>{n.d(t,{$M:()=>z,$l:()=>c,B4:()=>E,E3:()=>S,Gb:()=>N,I$:()=>_,Jl:()=>v,MI:()=>r,Mt:()=>y,N$:()=>J,N7:()=>M,NH:()=>A,OO:()=>j,OQ:()=>g,QO:()=>C,SB:()=>w,SP:()=>k,T4:()=>h,Vm:()=>T,WG:()=>d,X_:()=>$,ar:()=>s,cn:()=>u,fL:()=>m,fq:()=>l,g8:()=>U,gN:()=>b,hI:()=>a,hl:()=>L,ih:()=>B,io:()=>W,iu:()=>I,j$:()=>x,j3:()=>K,lG:()=>o,lV:()=>D,n7:()=>O,oF:()=>R,ss:()=>F,v$:()=>p,vJ:()=>q,zM:()=>H,zp:()=>P});const o=(e,t)=>`_fo_${t}_${e}`,s=e=>`_co_${e}`,i="_cos_",c=(e,t,n)=>`${i}${t}_${e}_${n}`,r=(e,t)=>`${i}${t}_${e}`,a=()=>"_cas_",m=e=>`_ca_${e}`,d=e=>`_crs_${e}`,l=e=>`_evt_${e}`,u=()=>"_evts_",h=e=>`_liveStream_${e}`,_=e=>`_grp_${e}`,p=()=>"_grps_",j=e=>`_inc_${e}`,f="_contr_",g=(e,t,n)=>`${f}${t}_${e}_${n}`,b=()=>"_bcms_",C=(e,t)=>`_feed_${e}_${t}`,O=e=>`_feed_st_${e}`,v=e=>`_virtualized_scroll_st_${e}`,x=e=>`_feed_spos_${e}`,k=e=>`_adv_${e}`,y=()=>"_pmss_",A=e=>`_pms_${e}`,S=e=>`_ppo_${e}`,$=e=>`_pord_${e}`,N="_cFolWidget_",F="_cSugWidget_",P="_cPopWidget_",w="_uFolWidget_",T="_uFoldWidget_",W="_uCreCoursesWidget_",I="_uUserLives_",R="_uConWidget_",E="_uConReqWidget_",D="_uConReqSentWidget_",L="_fTrendWidget_",M="_rFeedWidget_",B="_pTrendWidget_",q="_pSugWidget_",H="_iListWidget_",z="_iSugWidget_",J="_pSugWidget_",U="_gSubWidget_",K=(e,t=void 0)=>`${e}${void 0!==t?t:""}`},95241:(e,t,n)=>{n.d(t,{H:()=>o});const o="SCCommentsFeedObject"}}]);